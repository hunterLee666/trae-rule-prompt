---
name: Team Collaboration Rules
description: 团队协作规则 - 多人协作、代码审查、冲突解决
version: "8.1"
priority: 85
alwaysApply: true
---

# 团队协作规则

> **"协作有序，效率倍增。"**

## 一、协作模式

### 1.1 协作角色

```yaml
角色定义:
  Owner:
    权限: 完全控制
    职责: 项目决策、权限管理
    数量: 1-2人
    
  Maintainer:
    权限: 代码合并、分支管理
    职责: 代码审查、版本发布
    数量: 2-5人
    
  Developer:
    权限: 代码提交、PR创建
    职责: 功能开发、Bug修复
    数量: 不限
    
  Reviewer:
    权限: 代码审查、评论
    职责: 质量把关、最佳实践
    数量: 3-10人
```

### 1.2 协作流程

```yaml
标准开发流程:
  1. 任务分配
     - 创建Issue/Task
     - 分配责任人
     - 设置优先级
     
  2. 分支创建
     - 从main创建feature分支
     - 分支命名规范: feature/xxx
     - 定期同步主分支
     
  3. 开发阶段
     - 小步提交
     - 编写测试
     - 本地验证
     
  4. 代码审查
     - 创建Pull Request
     - 指定审查者
     - 处理审查意见
     
  5. 合并部署
     - 通过所有检查
     - 合并到主分支
     - 触发部署流程
```

---

## 二、分支管理

### 2.1 分支策略

```yaml
Git Flow:
  main:
    用途: 生产环境代码
    保护: 必须通过PR合并
    标签: 版本发布
    
  develop:
    用途: 开发集成分支
    保护: 需要审查
    合并: feature分支
    
  feature/*:
    用途: 功能开发
    来源: develop
    命名: feature/功能名称
    
  hotfix/*:
    用途: 紧急修复
    来源: main
    合并: main + develop
    
  release/*:
    用途: 发布准备
    来源: develop
    命名: release/版本号

Trunk Based (简化版):
  main:
    用途: 主分支
    保护: 必须通过PR
    
  feature/*:
    用途: 短期功能分支
    生命周期: < 1天
    合并: 快速合并到main
```

### 2.2 分支保护规则

```yaml
main分支保护:
  - 禁止直接推送
  - 必须通过PR合并
  - 至少1个审查批准
  - 必须通过CI检查
  - 必须解决所有对话

develop分支保护:
  - 禁止直接推送
  - 必须通过PR合并
  - 至少1个审查批准
  - 必须通过CI检查
```

### 2.3 分支命名规范

```yaml
命名格式: 类型/描述-编号

类型:
  feature: 新功能
  bugfix: Bug修复
  hotfix: 紧急修复
  refactor: 重构
  docs: 文档更新
  test: 测试相关

示例:
  feature/user-authentication-123
  bugfix/login-error-456
  hotfix/security-patch-789
  refactor/api-structure-012
```

---

## 三、代码审查

### 3.1 审查流程

```yaml
审查步骤:
  1. PR创建
     - 填写PR模板
     - 关联Issue
     - 指定审查者
     
  2. 自动检查
     - CI/CD流水线
     - 代码风格检查
     - 测试覆盖率
     
  3. 人工审查
     - 代码逻辑
     - 设计模式
     - 最佳实践
     
  4. 审查反馈
     - 提出修改建议
     - 讨论设计方案
     - 确认修改完成
     
  5. 审查结论
     - Approve: 批准合并
     - Request Changes: 需要修改
     - Comment: 仅评论
```

### 3.2 审查清单

```yaml
代码质量:
  - [ ] 代码风格符合规范
  - [ ] 无明显性能问题
  - [ ] 无安全漏洞
  - [ ] 错误处理完善
  - [ ] 日志记录合理

设计评审:
  - [ ] 设计模式合理
  - [ ] 模块职责清晰
  - [ ] 接口设计合理
  - [ ] 可扩展性良好

测试覆盖:
  - [ ] 单元测试完整
  - [ ] 边界条件覆盖
  - [ ] 异常场景测试
  - [ ] 测试可读性好

文档更新:
  - [ ] API文档更新
  - [ ] README更新
  - [ ] 注释清晰完整
  - [ ] 变更日志更新
```

### 3.3 审查时效

```yaml
审查时限:
  紧急PR: 4小时内
  普通PR: 24小时内
  大型PR: 48小时内

超时处理:
  - 自动提醒审查者
  - 通知项目维护者
  - 记录审查延迟
```

---

## 四、冲突解决

### 4.1 代码冲突

```yaml
冲突类型:
  内容冲突:
    原因: 同一文件不同修改
    解决: 手动合并，保留正确逻辑
    
  结构冲突:
    原因: 文件移动/重命名
    解决: 确认最终结构，重新组织
    
  逻辑冲突:
    原因: 功能相互影响
    解决: 协调开发者，统一设计

解决流程:
  1. 识别冲突文件
  2. 分析冲突原因
  3. 与相关开发者沟通
  4. 手动解决冲突
  5. 验证解决结果
  6. 更新测试用例
```

### 4.2 设计冲突

```yaml
设计冲突类型:
  技术选型冲突:
    示例: 使用框架A还是框架B
    解决: 技术评审会议
    
  架构设计冲突:
    示例: 模块划分方式不同
    解决: 架构师决策
    
  实现方案冲突:
    示例: 算法选择不同
    解决: 性能对比测试

解决机制:
  1. 技术讨论会议
  2. 方案对比分析
  3. 投票决策
  4. 架构师最终决定
```

### 4.3 优先级冲突

```yaml
任务优先级:
  P0 - 紧急:
    条件: 生产故障、安全漏洞
    处理: 立即处理，中断其他任务
    
  P1 - 高:
    条件: 核心功能、重要Bug
    处理: 当天处理
    
  P2 - 中:
    条件: 常规功能、优化
    处理: 本周处理
    
  P3 - 低:
    条件: 改进建议、文档
    处理: 排期处理

资源冲突:
  - 同一资源被多个任务需要
  - 按优先级分配
  - 协调时间错峰使用
```

---

## 五、沟通规范

### 5.1 沟通渠道

```yaml
同步沟通:
  会议:
    类型: 站会、评审会、复盘会
    时长: 控制在30分钟内
    频率: 按需召开
    
  即时通讯:
    工具: Slack, Teams, 钉钉
    用途: 紧急问题、快速确认
    响应: 工作时间内2小时内

异步沟通:
  Issue/PR评论:
    用途: 技术讨论、决策记录
    优点: 可追溯、可搜索
    
  文档:
    类型: 设计文档、API文档
    位置: Wiki, 代码仓库
    更新: 随代码同步更新
```

### 5.2 沟通模板

```yaml
Issue模板:
  ## 问题描述
  [清晰描述问题]
  
  ## 复现步骤
  1. ...
  2. ...
  
  ## 期望结果
  [描述期望的行为]
  
  ## 实际结果
  [描述实际的行为]
  
  ## 环境信息
  - 版本: 
  - 环境:

PR模板:
  ## 变更说明
  [描述本次变更的内容]
  
  ## 变更类型
  - [ ] 新功能
  - [ ] Bug修复
  - [ ] 重构
  - [ ] 文档更新
  
  ## 测试说明
  [描述如何测试]
  
  ## 相关Issue
  Closes #xxx
```

### 5.3 反馈规范

```yaml
正面反馈:
  - 肯定好的设计
  - 表扬优秀实践
  - 分享学习价值

建设性反馈:
  - 描述问题而非指责
  - 提供具体建议
  - 解释原因和影响

反馈示例:
  不好的反馈:
    "这段代码写得不好"
    
  好的反馈:
    "建议将这个函数拆分成更小的函数，
    这样可以提高可测试性和可维护性。
    参考：[链接到最佳实践]"
```

---

## 六、知识共享

### 6.1 文档规范

```yaml
必写文档:
  - README.md: 项目介绍、快速开始
  - CHANGELOG.md: 版本变更记录
  - CONTRIBUTING.md: 贡献指南
  - API文档: 接口说明

文档更新:
  - 功能开发时同步更新
  - PR中包含文档变更
  - 定期审查文档准确性
```

### 6.2 知识传递

```yaml
传递方式:
  代码审查:
    - 在审查中分享知识
    - 解释设计决策
    - 推荐最佳实践
    
  技术分享:
    - 定期技术分享会
    - 新技术调研分享
    - 问题解决经验
    
  结对编程:
    - 复杂功能结对开发
    - 新人指导
    - 知识密集区域
```

---

## 七、工具集成

### 7.1 协作工具

```yaml
代码管理:
  平台: GitHub, GitLab, Bitbucket
  功能: 仓库管理、PR流程、CI/CD

项目管理:
  工具: Jira, Trello, GitHub Projects
  功能: 任务跟踪、看板、里程碑

沟通工具:
  即时通讯: Slack, Teams
  文档协作: Notion, Confluence
  视频会议: Zoom, Teams
```

### 7.2 自动化集成

```yaml
CI/CD集成:
  触发条件:
    - PR创建/更新
    - 分支合并
    - 定时构建
    
  检查项:
    - 代码风格检查
    - 单元测试
    - 集成测试
    - 安全扫描
    
  通知:
    - 构建状态通知
    - 审查请求通知
    - 合并完成通知
```
