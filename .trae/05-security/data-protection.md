---
name: Data Protection
description: 数据保护 - 敏感数据识别与处理
version: "7.0"
priority: 100
alwaysApply: true
---

# 数据保护

> **"数据安全，责任重大。"**

## 一、敏感数据类型

```yaml
凭证类:
  - API密钥
  - 访问令牌
  - 密码
  - 私钥
  - 证书

个人信息:
  - 姓名
  - 邮箱
  - 电话
  - 地址
  - 身份证号

商业敏感:
  - 商业机密
  - 财务数据
  - 客户数据
  - 算法实现
```

## 二、检测规则

```yaml
文件名检测:
  敏感文件:
    - .env
    - .env.*
    - *.key
    - *.pem
    - credentials*
    - secrets*
    - password*

内容模式检测:
  凭证模式:
    - API_KEY\s*=\s*['"].+['"]
    - api_key\s*:\s*['"].+['"]
    - password\s*=\s*['"].+['"]
    - token\s*=\s*['"].+['"]
    - secret\s*=\s*['"].+['"]
    
  个人信息模式:
    - 邮箱: [\w.-]+@[\w.-]+\.\w+
    - 电话: \d{11}
    - 身份证: \d{17}[\dXx]
```

## 三、脱敏策略

```yaml
脱敏方法:
  完全隐藏:
    格式: [REDACTED]
    适用: 密码、私钥
    
  部分隐藏:
    格式: abc***@example.com
    适用: 邮箱、电话
    
  哈希替换:
    格式: hash(original)
    适用: 需要验证的场景
    
  占位符:
    格式: ${ENV_VAR}
    适用: 配置文件

脱敏示例:
  原始: API_KEY=sk-1234567890abcdef
  脱敏: API_KEY=***
  
  原始: password: mypassword123
  脱敏: password: [REDACTED]
  
  原始: email: user@example.com
  脱敏: email: u***@example.com
```

## 四、处理流程

```yaml
检测流程:
  1. 扫描文件
     - 检查文件名
     - 检查文件内容
     
  2. 识别敏感数据
     - 匹配检测规则
     - 标记敏感位置
     
  3. 分类处理
     - 凭证类: 完全隐藏
     - 个人信息: 部分隐藏
     - 商业敏感: 根据策略
     
  4. 记录日志
     - 记录检测情况
     - 记录处理方式
```

## 五、安全传输

```yaml
传输加密:
  - 使用HTTPS
  - TLS 1.2+
  - 证书验证

数据最小化:
  - 只传输必要数据
  - 脱敏后传输
  - 避免重复传输

传输审计:
  - 记录传输日志
  - 监控异常传输
  - 定期审计
```

## 六、最佳实践

```yaml
开发实践:
  - 不在代码中硬编码密钥
  - 使用环境变量
  - 使用密钥管理服务
  - 定期轮换密钥

存储实践:
  - 加密存储敏感数据
  - 访问控制
  - 审计日志
  - 定期清理

传输实践:
  - 加密传输
  - 数据最小化
  - 安全通道
  - 传输审计
```
