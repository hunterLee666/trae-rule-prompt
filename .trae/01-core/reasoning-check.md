---
name: Reasoning Check
description: 推理深度检查触发器 - 复杂问题时强制执行
version: "1.0"
priority: 90
alwaysApply: true
trigger: "during_complex_analysis"
---

# 推理深度检查触发器

> **⚠️ 强制规则：复杂问题分析时必须使用高级推理**

---

## 一、触发条件

```yaml
触发场景:
  - 问题涉及因果关系分析
  - 需要多因素综合判断
  - 涉及预测和趋势分析
  - 问题诊断和根因分析
  - 方案对比和决策支持
  - 用户询问"为什么"类问题

不触发场景:
  - 简单事实查询
  - 单一操作请求
  - 明确的执行指令
```

---

## 二、推理类型

### 2.1 基础推理类型

```yaml
演绎推理:
  定义: 从一般到特殊的推理
  特点: 结论必然为真（前提为真时）
  应用: 数学证明、逻辑验证
  示例: 
    前提1: 所有人都会死
    前提2: 苏格拉底是人
    结论: 苏格拉底会死

归纳推理:
  定义: 从特殊到一般的推理
  特点: 结论可能为真（概率性）
  应用: 模式识别、经验总结
  示例:
    观察: 天鹅A是白的，天鹅B是白的...
    结论: 所有天鹅都是白的

类比推理:
  定义: 基于相似性的推理
  特点: 结论可能为真（相似度相关）
  应用: 问题迁移、创新思维
  示例:
    前提: A与B在X,Y方面相似
    前提: A有属性Z
    结论: B可能有属性Z
```

### 2.2 高级推理类型

```yaml
因果推理:
  定义: 基于因果关系的推理
  特点: 需要识别因果链
  应用: 问题诊断、决策分析
  示例:
    观察: 系统响应变慢
    分析: 数据库查询增加 → 连接池耗尽 → 响应变慢
    结论: 需要优化数据库查询

反事实推理:
  定义: 假设性场景推理
  特点: 探索可能性
  应用: 风险评估、方案比较
  示例:
    假设: 如果使用Redis缓存
    推理: 查询压力降低 → 数据库负载下降 → 响应时间缩短
    结论: Redis缓存是有效方案

抽象推理:
  定义: 从具体到抽象的推理
  特点: 提取模式、形成概念
  应用: 框架设计、模式识别
  示例:
    观察: 多个相似实现
    抽象: 提取通用模式
    应用: 创建可复用框架
```

---

## 三、推理复杂度等级

```yaml
L1 - 简单推理:
  步骤: 1-2步
  特点: 单一推理类型
  示例: 简单的因果关系
  处理: 直接回答

L2 - 中等推理:
  步骤: 3-5步
  特点: 混合推理类型
  示例: 多因素分析
  处理: 展示推理过程

L3 - 复杂推理:
  步骤: 5-10步
  特点: 多层推理链
  示例: 系统性问题分析
  处理: 必须展示完整推理链

L4 - 专家推理:
  步骤: 10+步
  特点: 跨领域推理
  示例: 架构设计、战略规划
  处理: 分阶段展示推理
```

---

## 四、推理输出模板

```markdown
## 🧠 推理分析报告

### 问题定义
- **核心问题**: [问题描述]
- **推理类型**: [因果/反事实/类比等]
- **复杂度等级**: L1/L2/L3/L4

### 推理链

```
观察/前提
    ↓
[推理步骤1] - [推理类型]
    ↓
[推理步骤2] - [推理类型]
    ↓
[推理步骤3] - [推理类型]
    ↓
结论
```

### 详细分析

#### 步骤1: [标题]
- **输入**: [前提/观察]
- **推理**: [推理过程]
- **输出**: [中间结论]

#### 步骤2: [标题]
- **输入**: [上一步输出]
- **推理**: [推理过程]
- **输出**: [中间结论]

### 结论
- **主要结论**: [最终结论]
- **置信度**: 高/中/低
- **假设条件**: [关键假设]

### 反事实分析
- **如果** [条件A]: [可能结果]
- **如果** [条件B]: [可能结果]
```

---

## 五、快速检查卡

```
┌─────────────────────────────────────────────┐
│           推理深度速查表                     │
├─────────────────────────────────────────────┤
│                                             │
│  问题类型识别:                               │
│    □ 因果分析？ → 因果推理                   │
│    □ 方案对比？ → 反事实推理                 │
│    □ 模式识别？ → 类比推理                   │
│    □ 规律总结？ → 归纳推理                   │
│                                             │
│  推理深度:                                   │
│    L1 简单: 1-2步，直接回答                 │
│    L2 中等: 3-5步，展示过程                 │
│    L3 复杂: 5-10步，完整推理链              │
│    L4 专家: 10+步，分阶段展示               │
│                                             │
│  输出要求:                                   │
│    □ 问题定义清晰                           │
│    □ 推理链完整                             │
│    □ 结论有依据                             │
│    □ 假设条件标注                           │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 六、违规示例

```yaml
❌ 错误示例:
  用户: "为什么系统变慢了？"
  回答: "可能是数据库问题，检查一下。"

✅ 正确示例:
  用户: "为什么系统变慢了？"
  回答:
    "## 🧠 推理分析
    
    ### 因果推理链
    观察: 系统响应时间从100ms增加到2000ms
      ↓
    分析: 响应时间突增通常由以下原因导致
      - 数据库查询变慢
      - 内存不足
      - 网络延迟
      ↓
    验证: 检查监控数据
      - CPU: 正常 (30%)
      - 内存: 正常 (60%)
      - 数据库连接数: 异常 (接近上限)
      ↓
    结论: 数据库连接池耗尽导致响应变慢
    
    ### 建议措施
    1. 增加连接池大小
    2. 优化慢查询
    3. 添加查询缓存"
```

---

**记住**：深度推理创造深度价值，浅层回答解决不了复杂问题！
