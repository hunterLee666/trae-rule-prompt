---
name: Scale Check
description: 大型项目检查触发器 - 大型项目处理时建议执行
version: "1.0"
priority: 85
alwaysApply: true
trigger: "during_large_project_handling"
---

# 大型项目检查触发器

> **⚠️ 建议：处理大型项目时考虑规模因素**

---

## 一、触发条件

```yaml
触发场景:
  - 项目文件数 > 100
  - 代码行数 > 10,000
  - 依赖数 > 20
  - 需要跨模块修改
  - 用户明确说明大型项目

不触发场景:
  - 小型项目
  - 单文件修改
  - 用户明确跳过
```

---

## 二、项目规模分类

```yaml
小型项目:
  文件数: < 100
  代码行数: < 10,000
  依赖数: < 20
  处理方式: 直接操作

中型项目:
  文件数: 100 - 500
  代码行数: 10,000 - 100,000
  依赖数: 20 - 100
  处理方式: 模块化操作

大型项目:
  文件数: 500 - 2000
  代码行数: 100,000 - 1,000,000
  依赖数: 100 - 500
  处理方式: 分层架构、渐进式修改

超大型项目:
  文件数: > 2000
  代码行数: > 1,000,000
  依赖数: > 500
  处理方式: 微服务化、独立模块处理
```

---

## 三、大型项目处理策略

### 3.1 架构分层

```yaml
分层架构:
  表示层:
    职责: UI/UX、API接口
    关注: 用户体验、接口设计
  
  业务层:
    职责: 业务逻辑、流程控制
    关注: 业务规则、事务管理
  
  数据层:
    职责: 数据存储、数据访问
    关注: 数据一致性、性能优化
  
  基础设施层:
    职责: 日志、配置、监控
    关注: 可观测性、运维支持
```

### 3.2 模块化策略

```yaml
模块划分原则:
  高内聚: 模块内部功能紧密相关
  低耦合: 模块之间依赖最小化
  单一职责: 每个模块只负责一个功能

模块边界:
  - 明确的接口定义
  - 独立的配置管理
  - 隔离的测试范围
  - 独立的部署能力
```

### 3.3 依赖管理

```yaml
依赖原则:
  - 依赖倒置: 高层模块不依赖低层模块
  - 接口隔离: 使用小接口而非大接口
  - 依赖注入: 通过注入而非硬编码

依赖检查:
  □ 循环依赖检测
  □ 版本冲突检查
  □ 安全漏洞扫描
  □ 许可证兼容性
```

---

## 四、性能优化策略

```yaml
代码层面:
  - 避免全局变量
  - 使用懒加载
  - 实施缓存策略
  - 优化循环和递归

架构层面:
  - 服务拆分
  - 数据库分片
  - 缓存层设计
  - 异步处理

构建层面:
  - 增量编译
  - 并行构建
  - 构建缓存
  - 依赖预构建
```

---

## 五、大型项目检查清单

```yaml
架构检查:
  □ 分层架构清晰？
  □ 模块边界明确？
  □ 依赖关系合理？
  □ 循环依赖存在？

性能检查:
  □ 性能瓶颈识别？
  □ 缓存策略实施？
  □ 数据库优化？
  □ 资源使用合理？

可维护性检查:
  □ 代码风格统一？
  □ 文档完整？
  □ 测试覆盖充分？
  □ 监控告警配置？
```

---

## 六、快速检查卡

```
┌─────────────────────────────────────────────┐
│           大型项目速查表                     │
├─────────────────────────────────────────────┤
│                                             │
│  规模判断:                                   │
│    小型: <100文件, <1万行                   │
│    中型: 100-500文件, 1-10万行              │
│    大型: 500-2000文件, 10-100万行           │
│    超大: >2000文件, >100万行                │
│                                             │
│  处理策略:                                   │
│    □ 分层架构                               │
│    □ 模块化                                 │
│    □ 依赖管理                               │
│    □ 性能优化                               │
│                                             │
│  检查要点:                                   │
│    □ 循环依赖                               │
│    □ 性能瓶颈                               │
│    □ 测试覆盖                               │
│    □ 文档完整                               │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 七、违规示例

```yaml
❌ 错误示例:
  # 大型项目中直接修改核心模块
  # 未考虑影响范围
  def modify_core():
      global_core.data = new_value

✅ 正确示例:
  # 通过接口修改，考虑影响范围
  class CoreService:
      def update_data(self, new_value):
          """更新核心数据，触发相关事件"""
          old_value = self._data
          self._data = new_value
          self._event_bus.emit("data_changed", {
              "old": old_value,
              "new": new_value
          })
```

---

**记住**：大项目需要大智慧，分层模块化是关键！
